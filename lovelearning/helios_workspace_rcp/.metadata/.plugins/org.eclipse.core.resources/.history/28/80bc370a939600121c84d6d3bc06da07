package rcp_02.actions;

import org.eclipse.jface.action.IAction;
import org.eclipse.jface.viewers.ISelection;
import org.eclipse.ui.IWorkbenchWindow;
import org.eclipse.ui.IWorkbenchWindowActionDelegate;

public class OpenFileAction implements IWorkbenchWindowActionDelegate {

	IWorkbenchWindow window;
	 
	@Override
	public void run(IAction action) {
		 IViewReference[] vfs = window.getActivePage().getViewReferences();
		         IViewPart vw;
		         for(int i=0; i<vfs.length; i++){
		              vw = vfs[i].getView(false);
		              if(vw.getTitle().equals("Ê¹ÓÃActive X¿Ø¼þ")){
		                     OleClientSite client = new OleClientSite(((OleView)vw).frame,SWT.NONE,"Shell.Explorer.2");
		                     client.doVerb(OLE.OLEIVERB_SHOW);
		                     OleAutomation oa = new OleAutomation(client);
		                     Variant str = new Variant("http://www.blogjava.net/");
		                     oa.invoke(104, new Variant[]{str});
		         
		              }
		         }

	}

	@Override
	public void selectionChanged(IAction action, ISelection selection) {
		// TODO Auto-generated method stub

	}

	@Override
	public void dispose() {
		// TODO Auto-generated method stub

	}

	@Override
	public void init(IWorkbenchWindow window) {
		 this.window = window;
	}

}
